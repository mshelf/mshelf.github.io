webpackJsonp([0],{148:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function u(){f.default.render(c.default.createElement(h.HashRouter,null,c.default.createElement(h.Route,{path:"/:channelId?",component:(0,h.withRouter)(S)})),document.getElementById("app"))}var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();n(149);var s=n(5),c=r(s),d=n(92),f=r(d),h=n(117),p=n(265),y=r(p),m=n(266),v=r(m),k=n(267),g=r(k),b=n(354),_=r(b),w=n(355),P=r(w),E=n(356),x=r(E),T=n(379),C=r(T),I=n(380),O=r(I);window.initApp=function(){(0,O.default)(),"loading"!==document.readyState?u():document.addEventListener("DOMContentLoaded",function(){u()})};var S=function(e){function t(){a(this,t);var e=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.handleToggleMenu=e.handleToggleMenu.bind(e),e.handleSelectChannel=e.handleSelectChannel.bind(e),e.state={isMenuForceShow:!1},e.channelsRegistry=new P.default(_.default),e.favoritesStore=new C.default(e.channelsRegistry),e.tracksLoader=new x.default(e.channelsRegistry),e}return i(t,e),l(t,[{key:"handleToggleMenu",value:function(e){e.preventDefault(),e.stopPropagation(),this.setState({isMenuForceShow:!this.state.isMenuForceShow})}},{key:"handleSelectChannel",value:function(e){this.props.match.params.channelId!==e&&(this.props.history.push(e),this.setState({isMenuForceShow:!1}))}},{key:"render",value:function(){var e=this.props.match.params.channelId;return c.default.createElement("div",null,c.default.createElement(v.default,{onToggleMenu:this.handleToggleMenu}),c.default.createElement(y.default,{channelId:e,channelsRegistry:this.channelsRegistry,favoritesStore:this.favoritesStore,isForceShow:this.state.isMenuForceShow,onSelectChannel:this.handleSelectChannel}),c.default.createElement(g.default,{channelId:e,favoritesStore:this.favoritesStore,tracksLoader:this.tracksLoader}))}}]),t}(c.default.Component)},149:function(e,t){},265:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(5),s=r(l),c=n(6),d=r(c),f=n(34),h=function(e){function t(){a(this,t);var e=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.handleMenuItemClick=e.handleMenuItemClick.bind(e),e.noChangeExpandedPath=!1,e.state={expandedPath:{}},e}return i(t,e),u(t,[{key:"componentWillMount",value:function(){var e=void 0,t=this.props,n=t.channelId,r=t.favoritesStore;e=n?this.getExpandedPath(n):this.getExpandedPath(r.getFavoritesChannels().length>0?"Favorites":"Genres"),this.setExpandedPath(e)}},{key:"componentWillReceiveProps",value:function(e){if(e.channelId!==this.props.channelId&&!this.noChangeExpandedPath){var t=this.getExpandedPath(e.channelId);this.setExpandedPath(t)}}},{key:"componentDidUpdate",value:function(e,t){this.noChangeExpandedPath=!1}},{key:"setExpandedPath",value:function(e){this.noChangeExpandedPath=!1,this.setState({expandedPath:e})}},{key:"handleMenuItemClick",value:function(e){e.stopPropagation(),e.preventDefault();var t=e.currentTarget.getAttribute("data-path"),n=e.currentTarget.getAttribute("data-channel-id");if(n)this.noChangeExpandedPath=!0,this.props.onSelectChannel(n);else{if(e.target.className.includes("expanded")){var r=t.split("\\");r.pop(),this.setExpandedPath(this.getExpandedPathByParts(r))}else{var a=this.getExpandedPath(t);this.setExpandedPath(a)}}}},{key:"getExpandedPath",value:function(e){if(void 0===e)return{};var t=e.split("\\");return this.getExpandedPathByParts(t)}},{key:"getExpandedPathByParts",value:function(e){for(var t="",n={},r=0;r<e.length;r++)t=(0,f.concatChannelIds)(t,e[r]),n[t]=!0;return n}},{key:"renderChannel",value:function(e,t,n,r){return s.default.createElement("li",{key:e,"data-channel-id":e,"data-path":n,className:r?"app-menu__item channel expanded":"app-menu__item channel",onClick:this.handleMenuItemClick},t)}},{key:"renderFolder",value:function(e,t,n,r){return s.default.createElement("li",{key:t,"data-path":t,className:n?"app-menu__item folder expanded":"app-menu__item folder",onClick:this.handleMenuItemClick},e,s.default.createElement("ul",{className:n?"app-menu__submenu expanded":"app-menu__submenu"},r))}},{key:"renderBranch",value:function(e,t){for(var n=[],r=this.state.expandedPath,a=0;a<e.length;a++){var o=e[a],i=(0,f.concatChannelIds)(t,o.title);if(o.children){var u=this.renderBranch(o.children,i);if(!o.isJustContainer){var l=this.renderChannel(o.id,"All "+o.title,i,o.id===this.props.channelId);u.unshift(l)}n.push(this.renderFolder(o.title,i,r[i],u))}else{var s=o.id;n.push(this.renderChannel(s,o.title,i,s===this.props.channelId))}}return n}},{key:"render",value:function(){var e=this.props.channelsRegistry.tree,t=this.props.isForceShow?"app-menu force-show":"app-menu",n=this.props.favoritesStore.getFavoritesChannels(),r=[{title:"Favorites",isJustContainer:!0,children:n}];return s.default.createElement("div",{className:t},s.default.createElement("ul",{className:"app-menu__submenu app-menu__submenu--root expanded"},n.length>0?this.renderBranch(r,""):null,this.renderBranch(e,"")))}}]),t}(s.default.PureComponent);t.default=h,h.propTypes={channelId:d.default.string,onSelectChannel:d.default.func.isRequired,channelsRegistry:d.default.object.isRequired,favoritesStore:d.default.object.isRequired}},266:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(5),s=r(l),c=n(6),d=r(c),f=function(e){function t(){return a(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),u(t,[{key:"render",value:function(){return s.default.createElement("div",{className:"app-top-bar"},s.default.createElement("div",{className:"app-top-bar__menu-toggle",onClick:this.props.onToggleMenu},s.default.createElement("svg",{viewBox:"0 0 32 32"},s.default.createElement("path",{d:"M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"}))),s.default.createElement("div",{className:"app-top-bar__header"},s.default.createElement("div",{className:"app-top-bar__logo"}),s.default.createElement("div",{className:"app-top-bar__header-text"},"Music Shelf Radio")))}}]),t}(s.default.Component);t.default=f,f.propTypes={onToggleMenu:d.default.func}},267:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(5),s=r(l),c=n(6),d=r(c),f=n(121),h=r(f),p=n(34),y={playerVars:{autoplay:1}},m=/(\(|\[)(Official|HD).*(\)|\])/i,v=function(e){function t(){a(this,t);var e=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.state={track:null,trackName:null,error:!1},e.handleNextClick=e.handleNextClick.bind(e),e.handlePlayerStateChange=e.handlePlayerStateChange.bind(e),e.autoChangeTrackTimeoutId=0,e.checkCurrentTrackIntervalId=0,e.isStarted=!1,e}return i(t,e),u(t,[{key:"componentDidMount",value:function(){this.props.channelId&&this.setChannel(this.props.channelId)}},{key:"componentWillReceiveProps",value:function(e){e.channelId!==this.props.channelId&&this.setChannel(e.channelId)}},{key:"setChannel",value:function(e){if(!e)return void this.setTrack(null);this.props.favoritesStore.channelWasOpened(e),this.loadNextTrack(e)}},{key:"loadNextTrack",value:function(e){var t=this;e||(e=this.props.channelId),this.props.tracksLoader.loadTracks(e).then(function(n){t.props.favoritesStore.trackWasStarted(e),t.setTrack(n)}).catch(function(){t.setError()})}},{key:"setTrack",value:function(e){(0,p.debugLog)("Set track"),(0,p.debugLog)(e),this.isStarted=!1;var t=e?e.title.replace(p.EMOJI_REGEX,"").replace(m,"").trim():null;this.setState({track:e,trackName:t,error:!1})}},{key:"setError",value:function(){this.setState({track:null,trackName:null,error:!0})}},{key:"checkCurrentTrack",value:function(e){var t=this.state.track.tracklist,n=e.getCurrentTime(),r=t.getTrackByTime(n);if(!r)return(0,p.debugLog)("Warning! Cannot select track by time "+n),void(0,p.debugLog)(t.tracks);r.title!==this.state.trackName&&((0,p.debugLog)("Set new track name: "+r.title),this.setState({trackName:r.title}))}},{key:"handleNextClick",value:function(){var e=this;this.setState({error:!1},function(){e.loadNextTrack()})}},{key:"handlePlayerStateChange",value:function(e){var t=this;clearTimeout(this.autoChangeTrackTimeoutId),clearInterval(this.checkCurrentTrackIntervalId);var n=this.state.track;if(n&&1===e.target.getPlayerState()){var r=e.target.getDuration(),a=n.sourceData.channel,o=a.maxTrackDuration?a.maxTrackDuration:1e3,i=r>o,u=n.tracklist.hasTracks();if(!this.isStarted&&(this.isStarted=!0,i)){var l=u?n.tracklist.getNearestStartTrackTime((0,p.randomIntFromInterval)(0,r-o)):(0,p.randomIntFromInterval)(0,r-o);return(0,p.debugLog)("Start new long video since "+l),void e.target.seekTo(l)}if(i){var s=Math.floor(e.target.getCurrentTime()),c=u>0?n.tracklist.getNearestStartTrackTime(s+o):s+o;this.autoChangeTrackTimeoutId=setTimeout(function(){t.loadNextTrack()},1e3*(c-s))}u&&(this.checkCurrentTrack(e.target),this.checkCurrentTrackIntervalId=setInterval(function(){t.checkCurrentTrack(e.target)},3e3))}}},{key:"getChannelNameById",value:function(e){return e.replace(/\\/g," / ")}},{key:"renderTrackBar",value:function(e){return s.default.createElement("div",{className:"app-track"},s.default.createElement("span",{className:"app-track__name"},e),s.default.createElement("div",{className:"app-track__buttons"},s.default.createElement("button",{className:"app-button app-track__button app-track__button--next",onClick:this.handleNextClick},"Next Track >>"),s.default.createElement("a",{className:"app-button app-button--blue app-track__button--search",href:"https://vk.com/search?c%5Bq%5D="+e+"&c%5Bsection%5D=audio",target:"_blank"},"VK"),s.default.createElement("a",{className:"app-button app-button--blue app-track__button--search",href:"https://music.yandex.ru/search?text="+e,target:"_blank"},"Yandex")))}},{key:"renderError",value:function(){return s.default.createElement("div",{className:"app-content__error-message"},s.default.createElement("h2",null,"Error"),s.default.createElement("p",null,"Unfortunately, we cannot load the track."),s.default.createElement("p",null,s.default.createElement("button",{onClick:this.handleNextClick,className:"app-button app-button--blue"},"Try again")))}},{key:"renderPlayer",value:function(){var e=this.state,t=e.track,n=e.trackName;return e.error?this.renderError():t?s.default.createElement("div",null,s.default.createElement("div",{className:"app-content__player-container"},s.default.createElement(h.default,{opts:y,className:"app-content__youtube-player",videoId:t.id,onEnd:this.handleNextClick,onStateChange:this.handlePlayerStateChange})),this.renderTrackBar(n)):null}},{key:"render",value:function(){var e=this.props.channelId;return e?s.default.createElement("div",{className:"app-content"},s.default.createElement("h1",{className:"app-content__header"},this.getChannelNameById(e)),this.renderPlayer()):null}}]),t}(s.default.PureComponent);t.default=v,v.propTypes={channelId:d.default.string,tracksLoader:d.default.object.isRequired,favoritesStore:d.default.object.isRequired}},34:function(e,t,n){"use strict";function r(e){return Math.floor(Math.random()*e)}function a(e,t){return Math.floor(Math.random()*(t-e))+e}function o(e){return e[r(e.length)]}function i(e){}function u(e,t){return e?e+"\\"+t:t}Object.defineProperty(t,"__esModule",{value:!0}),t.randomInt=r,t.randomIntFromInterval=a,t.randomArrayItem=o,t.debugLog=i,t.concatChannelIds=u;t.TIMING_REGEX=/(.*?)((\d+):)?(\d{1,2}):(\d{2})(.*)/,t.TRACK_NUMBER_REGEX=/^\s*\d+(\)|\.|:|(\s*-)|(\s*\|))+\s*/,t.EMOJI_REGEX=/[\uE000-\uF8FF]/g,t.EMPTY_BRACES_REGEX=/(\[\s*\])|(\(\s*\))/g,t.LETTERS_REGEX=/[а-яА-ЯёЁa-zA-Z]+/},354:function(e,t,n){"use strict";function r(e,t){return e.title>t.title?1:e.title<t.title?-1:0}Object.defineProperty(t,"__esModule",{value:!0}),t.default=[{title:"Genres",isJustContainer:!0,children:[{title:"Pop",keywords:{query:["pop music","поп музыка"],yearPostfix:1990}},{title:"Rock",children:[{title:"Hard Rock",keywords:{query:["Hard rock music","Glam rock music"],epochPostfix:1970}},{title:"Punk Rock",keywords:{epochPostfix:1970}},{title:"Post Rock",keywords:{query:["post rock","shoegaze music","post punk"],yearPostfix:2e3},useKeywordsFactor:2,maxTrackDuration:1800},{title:"Alternative Rock",keywords:{epochPostfix:1990,yearPostfix:2e3}},{title:"Progressive Rock",keywords:{epochPostfix:1970}},{title:"Russian Rock",noUseKeywords:!0}].sort(r)},{title:"Metal",children:[{title:"Heavy Metal",noUseKeywords:!0},{title:"Power Metal",keywords:{epochPostfix:2e3}},{title:"Thrash Metal",keywords:{epochPostfix:1980}},{title:"Black Metal",keywords:{epochPostfix:1980,yearPostfix:2e3}},{title:"Death Metal",children:[{title:"Melodic Death",keywords:{query:"Melodic death metal",yearPostfix:2e3}}].sort(r)},{title:"Metalcore",keywords:{yearPostfix:2e3}},{title:"Nu Metal",keywords:{yearPostfix:2e3,epochPostfix:1990}},{title:"Post Metal",keywords:{query:["post metal","post black metal"],yearPostfix:2005},useKeywordsFactor:2,maxTrackDuration:1800},{title:"Folk Metal",keywords:{query:["folk metal","pagan metal","viking metal"],yearPostfix:2005}}].sort(r)},{title:"Electronic",maxTrackDuration:10800,children:[{title:"Ambient",maxTrackDuration:10800,keywords:{query:"ambient music -chillout",yearPostfix:2015}},{title:"House",maxTrackDuration:10800,children:[{title:"Deep House",keywords:{yearPostfix:2010}},{title:"Electro House",keywords:{yearPostfix:2010}}].sort(r)},{title:"Trance",maxTrackDuration:10800,children:[{title:"Progressive Trance",maxTrackDuration:10800,keywords:{yearPostfix:2005}},{title:"Uplifting Trance",maxTrackDuration:10800,keywords:{yearPostfix:2005}},{title:"Vocal Trance",maxTrackDuration:10800,keywords:{yearPostfix:2005}},{title:"Goa-Psy Trance",maxTrackDuration:10800,keywords:{yearPostfix:2e3,epochPostfix:1990}}].sort(r)},{title:"Hardstyle",children:[{title:"Hardcore",keywords:{query:["Electronic hardcore","electronic hardstyle"],keywords:{yearPostfix:2e3,epochPostfix:1990}}},{title:"Gabber",keywords:{yearPostfix:2010}}].sort(r)},{title:"Light & Relax",maxTrackDuration:10800,children:[{title:"Lounge",maxTrackDuration:10800,keywords:{yearPostfix:2010}},{title:"Chillout",maxTrackDuration:10800,keywords:{yearPostfix:2010}},{title:"Trip-Hop",maxTrackDuration:10800,keywords:{yearPostfix:2010}}].sort(r)},{title:"Drum & Bass",maxTrackDuration:10800,keywords:{query:["Drum & Bass","liquid drum and bass"],yearPostfix:2005}},{title:"Techno",maxTrackDuration:10800,keywords:{query:["Techno","Detroit techno"],yearPostfix:2005,epochPostfix:1990}}].sort(r)},{title:"Hip-Hop & Rap",keywords:{yearPostfix:2e3,epochPostfix:1990},children:[{title:"Russian Rap",keywords:{yearPostfix:2005,epochPostfix:1990}}].sort(r)},{title:"Jazz",maxTrackDuration:3600,children:[{title:"Traditional Jazz",keywords:{query:["Traditional jazz","bebop jazz","classic jazz"]},useKeywordsFactor:3,maxTrackDuration:3600},{title:"Piano Jazz",maxTrackDuration:3600},{title:"Acid Jazz",maxTrackDuration:3600},{title:"Avantgarde Jazz",maxTrackDuration:3600}].sort(r)},{title:"Blues",keywords:{epochPostfix:1920}},{title:"Ska"},{title:"Classical",maxTrackDuration:3600},{title:"Instrumental",maxTrackDuration:3600,children:[{title:"Guitar",keywords:"instrumental guitar music",maxTrackDuration:3600},{title:"Piano",keywords:"instrumental piano music",maxTrackDuration:3600}].sort(r)}].sort(r)}].sort(r)},355:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t,n,r){e.forEach(function(e){var i=(0,s.concatChannelIds)(r,e.title);if(e.id=i,!e.isJustContainer){var u=o(i,e);t[i]=u}e.children&&a(e.children,t,n,i)})}function o(e,t){var n=Object.assign({id:e},t);return!t.isFolder&&t.children&&(n.childrenIds=i(e,t.children)),n}function i(e,t){var n=[];return t.forEach(function(t){u((0,s.concatChannelIds)(e,t.title),t,n)}),n}function u(e,t,n){n.push(e),t.children&&t.children.forEach(function(t){u((0,s.concatChannelIds)(e,t.title),t,n)})}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(34),c=function(){function e(t){r(this,e),this.registry={},a(t,this.registry,this.tree),this.tree=t}return l(e,[{key:"getChannelDescriptor",value:function(e){return this.registry[e]}}]),e}();t.default=c},356:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e){var t=e.keywords?e.keywords:e.title+" music";if("object"===(void 0===t?"undefined":l(t))&&Array.isArray(t)&&(t=(0,m.randomArrayItem)(t)),"string"==typeof t)return""+t;var n=void 0;switch(l(t.query)){case"undefined":n=e.title+" music";break;case"object":n=(0,m.randomArrayItem)(t.query);break;case"string":n=t.query}switch((0,m.randomInt)(3)%3){case 0:return n;case 1:if(t.yearPostfix){return n+" "+(0,m.randomIntFromInterval)(t.yearPostfix,(new Date).getFullYear()+1)}return n;case 2:if(t.epochPostfix){return n+" "+i(t.epochPostfix)}return n}}function i(e){var t=(new Date).getFullYear(),n=t-t%10;return e+10*(0,m.randomInt)(1+Math.floor((n-e)/10))+"s"}function u(e){return null===e||!e.id}Object.defineProperty(t,"__esModule",{value:!0});var l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n(357),d=r(c),f=n(376),h=r(f),p=n(378),y=r(p),m=n(34),v=function(){function e(t){a(this,e),this.channelsRegistry=t,this.artistsApiClient=new d.default,this.youtubeApiClient=new h.default}return s(e,[{key:"loadTracks",value:function(e){var t=this,n=this.channelsRegistry.getChannelDescriptor(e);return n.childrenIds&&(0,m.randomInt)(2)%2==0&&(n=this.channelsRegistry.getChannelDescriptor((0,m.randomArrayItem)(n.childrenIds))),this.artistsApiClient.hasArtists(n.id).then(function(e){var r=n.useKeywordsFactor?n.useKeywordsFactor:5;return!e||!n.noUseKeywords&&(0,m.randomInt)(r)%r==0?t._searchByKeywords(n):t._searchByArtists(n)})}},{key:"_searchByArtists",value:function(e){var t=this;return this.artistsApiClient.getRandomArtist(e.id).then(function(n){var r=n+" album";return t._getSearchResult(r,{channel:e,artist:n})}).then(function(n){return u(n)?t._searchByKeywords(e):n})}},{key:"_searchByKeywords",value:function(e){var t=o(e);return this._getSearchResult(t,{channel:e})}},{key:"_getSearchResult",value:function(e,t){var n=this;(0,m.debugLog)(e);var r=t.artist?t.artist:null;return this.youtubeApiClient.search(e,r).then(function(e){return n._getRandomVideoIdFromResultSet(e,function(e){return e.id})}).then(function(e){return null===e?null:n.youtubeApiClient.getVideoInfo(e)}).then(function(e){return null===e?((0,m.debugLog)("cannot load info"),{sourceData:t}):(e.tracklist=new y.default(e.description,t),Object.assign(e,{sourceData:t}))})}},{key:"_getRandomVideoIdFromResultSet",value:function(e,t){var n=this;if(e.items.length>0){var r=Math.floor(Math.random()*e.items.length),a=t(e.items[r]);return"youtube#video"===a.kind?((0,m.debugLog)(" - video "+a.videoId),a.videoId):((0,m.debugLog)(" - playlist "+a.playlistId),this.youtubeApiClient.getPlaylistItems(a.playlistId).then(function(e){return n._getRandomVideoIdFromResultSet(e,function(e){return e.snippet.resourceId})}))}return(0,m.debugLog)("!!! empty list"),null}}]),e}();t.default=v},357:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){return e.toLowerCase().replace(/[\\,\s]/g,"_")+"_"+t+".json"}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(86),u=function(e){return e&&e.__esModule?e:{default:e}}(i),l=function(){function e(){r(this,e),this.metadata=null,this.cache=null}return o(e,[{key:"hasArtists",value:function(e){return this._getMetadata().then(function(t){return Boolean(t[e])})}},{key:"getRandomArtist",value:function(e){var t=this.metadata[e],n=a(e,Math.floor(Math.random()*t)+1);return this._getArtistsByFile(n).then(function(e){return e[Math.floor(Math.random()*e.length)]})}},{key:"_getMetadata",value:function(){var e=this;return this.metadata?Promise.resolve(this.metadata):u.default.get("data/artists/metadata.json?"+Math.random()).then(function(t){return e.metadata=t.data,t.data})}},{key:"_getArtistsByFile",value:function(e){var t=this;return this.cache&&this.cache[e]?Promise.resolve(this.cache[e]):u.default.get("data/artists/"+e).then(function(n){return t.cache={},t.cache[e]=n.data,n.data})}}]),e}();t.default=l},376:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){return t=(0,c.default)(t),{items:e.items.filter(function(e){return(0,c.default)(e.snippet.title).startsWith(t)})}}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(86),l=r(u),s=n(146),c=r(s);c.default.defaults.mode="my",c.default.defaults.modes.my={replacement:"-",symbols:!1,remove:null,lower:!0,charmap:c.default.charmap,multicharmap:c.default.multicharmap};var d="AIzaSyDpQHUScIP1XnEoY6PdqgNRNGRRN5kO5vE",f="https://www.googleapis.com/youtube/v3",h=function(){function e(){a(this,e)}return i(e,[{key:"search",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=f+"/search?part=snippet&key="+d+"&type=video,playlist&maxResults=50&q="+encodeURIComponent(e)+"&fields=items(id,snippet/title)",r=l.default.get(n).then(function(e){return e.data});return t?r.then(function(e){return o(e,t)}):r}},{key:"getPlaylistItems",value:function(e){var t=f+"/playlistItems?part=snippet&key="+d+"&maxResults=30&playlistId="+e+"&fields=items(snippet/resourceId)";return l.default.get(t).then(function(e){return e.data})}},{key:"getVideoInfo",value:function(e){var t=f+"/videos?part=snippet&id="+e+"&fields=items(snippet/title,snippet/description)&key="+d;return l.default.get(t).then(function(t){return t.data.items.length>0?Object.assign({id:e},t.data.items[0].snippet):null})}}]),e}();t.default=h},378:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(34),i=function(){function e(t,n){r(this,e);var a=[],i=n.artist?n.artist.toLowerCase():null;if(t)for(var u=t.split("\n"),l=0;l<u.length;l++){var s=u[l].match(o.TIMING_REGEX);if(s){var c=s[1].trim(),d=s[6].trim(),f=3600*(s[3]?parseInt(s[2],10):0)+60*parseInt(s[4],10)+parseInt(s[5],10),h=c+" "+d;s&&o.LETTERS_REGEX.test(h)&&(h=h.replace(o.EMPTY_BRACES_REGEX,"").replace(o.EMOJI_REGEX,"").replace(o.TRACK_NUMBER_REGEX,"").trim(),n.artist&&-1===h.toLowerCase().indexOf(i)&&(h=n.artist+" - "+h),a.push({time:f,title:h}))}}this.tracks=a}return a(e,[{key:"getNearestStartTrackTime",value:function(e){if(0===this.tracks.length)return 0;for(var t,n=99999999,r=this.tracks[0],a=0;a<this.tracks.length;a++)(t=Math.abs(this.tracks[a].time-e))<n&&(n=t,r=this.tracks[a]);return r.time}},{key:"getTrackByTime",value:function(e){for(var t=0;t<this.tracks.length;t++)if(e<this.tracks[t].time)return t>0?this.tracks[t-1]:null;return this.hasTracks()?this.tracks[this.tracks.length-1]:null}},{key:"hasTracks",value:function(){return this.tracks.length>0}}]),e}();t.default=i},379:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){return e[1]<t[1]?1:e[1]>t[1]?-1:0}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function(){function e(t){r(this,e),this.isCacheValid=!1,this.channelsRegistry=t}return o(e,[{key:"channelWasOpened",value:function(e){var t=this._plusPointsAndGetData(e,5);this._saveData(t)}},{key:"trackWasStarted",value:function(e){var t=this._plusPointsAndGetData(e,1);this._saveData(t)}},{key:"getFavoritesChannels",value:function(){var e=this;if(!this.isCacheValid){var t=this._getData(),n=Object.entries(t).sort(a).slice(0,5).map(function(t){var n=t[0];return{id:n,title:e.channelsRegistry.getChannelDescriptor(n).title}});this.cache=n,this.isCacheValid=!0}return this.cache}},{key:"_getData",value:function(){var e=localStorage.getItem("favorites");return e?JSON.parse(e):{}}},{key:"_saveData",value:function(e){this.isCacheValid=!1,localStorage.setItem("favorites",JSON.stringify(e))}},{key:"_plusPointsAndGetData",value:function(e,t){var n=this._getData();if(void 0===n[e]&&(n[e]=0),n[e]+=t,n[e]>=300)for(var r in n)n[r]=Math.floor(n[r]/2);return n}}]),e}();t.default=i},380:function(e,t,n){"use strict";function r(){window.Promise=c.default,a(),o(),i()}function a(){Object.assign||Object.defineProperty(Object,"assign",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){if(void 0===e||null===e)throw new TypeError("Cannot convert first argument to object");for(var n=Object(e),r=1;r<arguments.length;r++){var a=arguments[r];if(void 0!==a&&null!==a)for(var o=Object.keys(Object(a)),i=0,u=o.length;i<u;i++){var l=o[i],s=Object.getOwnPropertyDescriptor(a,l);void 0!==s&&s.enumerable&&(n[l]=a[l])}}return n}})}function o(){var e=Function.bind.call(Function.call,Array.prototype.reduce),t=Function.bind.call(Function.call,Object.prototype.propertyIsEnumerable),n=Function.bind.call(Function.call,Array.prototype.concat);Object.values||(Object.values=function(r){return e(u(r),function(e,a){return n(e,"string"==typeof a&&t(r,a)?[r[a]]:[])},[])}),Object.entries||(Object.entries=function(r){return e(u(r),function(e,a){return n(e,"string"==typeof a&&t(r,a)?[[a,r[a]]]:[])},[])})}function i(){[].includes||(Array.prototype.includes=function(e){var t=Object(this),n=parseInt(t.length)||0;if(0===n)return!1;var r,a=parseInt(arguments[1])||0;for(a>=0?r=a:(r=n+a)<0&&(r=0);r<n;){var o=t[r];if(e===o||e!==e&&o!==o)return!0;r++}return!1}),String.prototype.includes||(String.prototype.includes=function(){return-1!==String.prototype.indexOf.apply(this,arguments)})}function u(e){return"object"===("undefined"==typeof Reflect?"undefined":l(Reflect))&&"function"==typeof Reflect.ownKeys?Reflect.ownKeys(e):"function"==typeof Object.getOwnPropertySymbols?Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e)):Object.getOwnPropertyNames(e)}Object.defineProperty(t,"__esModule",{value:!0});var l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.default=r;var s=n(147),c=function(e){return e&&e.__esModule?e:{default:e}}(s)}},[148]);